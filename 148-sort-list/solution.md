The solution with T: O(n * log(n)) and M: O(1) is a lot of code and edge cases.